# 「工银溯藏」项目结构文档

## 整体架构

「工银溯藏」项目采用前后端分离的架构设计，结合区块链技术实现藏品的数字身份溯源与流转管理。整体架构如下：

```
├── api/              # 后端API服务
├── blockchain/       # 区块链相关代码和配置
├── config/           # 项目配置文件
├── docs/             # 项目文档
├── frontend/         # 前端应用
├── .gitignore        # Git忽略规则
├── README.md         # 项目说明文档
└── package.json      # 项目依赖配置
```

## 详细模块说明

### 1. API服务 (api/)

API服务是系统的核心业务逻辑层，负责处理前端请求、与区块链网络交互以及数据持久化存储。

```
├── controllers/      # 控制器层，处理业务逻辑
│   └── collectible.js  # 藏品相关控制器
├── middleware/       # 中间件，处理认证、授权等
│   └── auth.js        # 认证相关中间件
├── models/           # 数据模型，定义数据结构
│   ├── brand.js       # 品牌模型
│   ├── collectible.js # 藏品模型
│   └── user.js        # 用户模型
├── routes/           # 路由定义
│   ├── auth.js        # 认证相关路由
│   ├── brand.js       # 品牌相关路由
│   └── collectible.js # 藏品相关路由
├── services/         # 服务层，封装外部API调用
│   └── icbcService.js # 工行API服务封装
├── package.json      # API服务依赖配置
└── server.js         # API服务入口文件
```

### 2. 区块链模块 (blockchain/)

区块链模块负责与Hyperledger Fabric网络交互，实现藏品的数字身份创建、流转记录等核心功能。

```
├── chaincode/        # 智能合约代码
│   └── collectible-chaincode.js # 藏品溯源智能合约
├── config/           # 区块链配置
├── network/          # 区块链网络配置
│   └── network-config.yaml      # 网络配置文件
├── index.js          # 区块链模块入口文件
└── package.json      # 区块链模块依赖配置
```

### 3. 配置模块 (config/)

配置模块集中管理项目的各种配置参数，支持多环境切换。

```
└── config.js         # 项目主配置文件
```

### 4. 文档模块 (docs/)

文档模块存放项目相关的各类文档，包括架构设计、接口说明、开发指南等。

```
└── PROJECT-STRUCTURE.md  # 项目结构文档（当前文件）
```

### 5. 前端应用 (frontend/)

前端应用提供用户界面，负责与用户交互并向后端API发送请求。

```
├── (待创建)           # 前端框架代码
```

## 核心流程说明

### 1. 藏品数字身份创建流程

1. 品牌管理员或工行管理员通过前端提交藏品信息
2. API服务接收请求并进行权限验证
3. API服务调用区块链模块，创建藏品数字身份
4. 区块链模块调用智能合约，将藏品信息存储在区块链上
5. API服务将藏品信息同步存储到MySQL数据库
6. 返回创建结果给前端

### 2. 藏品流转流程

1. 用户通过前端发起藏品转移请求
2. API服务接收请求并进行用户认证
3. API服务调用区块链模块，记录藏品所有权转移
4. 区块链模块调用智能合约，更新藏品所有权信息
5. API服务同步更新MySQL数据库中的藏品信息
6. 返回转移结果给前端

### 3. 藏品真伪验证流程

1. 用户通过前端提交藏品验证请求
2. API服务接收请求，调用区块链模块查询藏品信息
3. 区块链模块从区块链上获取藏品的完整流转历史
4. API服务根据查询结果判断藏品真伪
5. 返回验证结果给前端

## 技术栈说明

- **后端框架**: Express.js
- **数据库**: MySQL (mysql2/promise客户端)
- **区块链技术**: Hyperledger Fabric
- **身份认证**: JWT (JSON Web Token)
- **API文档**: Swagger (待集成)
- **容器化**: Docker (待集成)
- **CI/CD**: GitHub Actions (待集成)